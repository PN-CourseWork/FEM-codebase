"""
Create validation data file from Week 2 solutions PDF data.
Run this once to generate the validation_data.npz file.
"""

import numpy as np
from pathlib import Path

output_dir = Path(__file__).parent

# ============================================================
# EXERCISE 2.1 - Mesh Data
# ============================================================

# Case 1: Unit domain [0,1] x [0,1], 4x3 elements
ex21_case1_x = np.array([
    0, 0, 0, 0,
    0.25, 0.25, 0.25, 0.25,
    0.5, 0.5, 0.5, 0.5,
    0.75, 0.75, 0.75, 0.75,
    1.0, 1.0, 1.0, 1.0
])

ex21_case1_y = np.array([
    1.0, 0.6667, 0.3333, 0,
    1.0, 0.6667, 0.3333, 0,
    1.0, 0.6667, 0.3333, 0,
    1.0, 0.6667, 0.3333, 0,
    1.0, 0.6667, 0.3333, 0
])

ex21_case1_elmtab = np.array([
    [1, 6, 5], [2, 6, 1], [2, 7, 6], [3, 7, 2],
    [3, 8, 7], [4, 8, 3], [5, 10, 9], [6, 10, 5],
    [6, 11, 10], [7, 11, 6], [7, 12, 11], [8, 12, 7],
    [9, 14, 13], [10, 14, 9], [10, 15, 14], [11, 15, 10],
    [11, 16, 15], [12, 16, 11], [13, 18, 17], [14, 18, 13],
    [14, 19, 18], [15, 19, 14], [15, 20, 19], [16, 20, 15]
])

# Case 2: Domain [-2.5, 5.1] x [-4.8, 1.1]
ex21_case2_x = np.array([
    -2.5, -2.5, -2.5, -2.5,
    -0.6, -0.6, -0.6, -0.6,
    1.3, 1.3, 1.3, 1.3,
    3.2, 3.2, 3.2, 3.2,
    5.1, 5.1, 5.1, 5.1
])

ex21_case2_y = np.array([
    1.1, -0.8667, -2.8333, -4.8,
    1.1, -0.8667, -2.8333, -4.8,
    1.1, -0.8667, -2.8333, -4.8,
    1.1, -0.8667, -2.8333, -4.8,
    1.1, -0.8667, -2.8333, -4.8
])

# ============================================================
# EXERCISE 2.2 - Element Properties
# ============================================================

ex22_delta = 1.8683

ex22_abc = np.array([
    [-6.5633, -1.9667, -1.9000],
    [4.9167, 1.9667, 0],
    [5.3833, 0, 1.9000]
])

# Face normals
ex22_face1_n = np.array([0, -1])
ex22_face2_n = np.array([0.7192, 0.6948])
ex22_face3_n = np.array([-1, 0])

# ============================================================
# EXERCISE 2.3 - Assembly (before BC application)
# ============================================================

# Case 1: Unit domain
ex23_case1_B = np.array([
    [-0.6667, -0.3750, 1.0417, 0, 0],
    [-1.3333, -0.3750, 2.0833, -0.3750, 0],
    [-1.3333, -0.3750, 2.0833, -0.3750, 0],
    [-0.6667, 0, 1.0417, -0.3750, 0],
    [-0.6667, -0.7500, 2.0833, 0, -0.6667],
    [-1.3333, -0.7500, 4.1667, -0.7500, -1.3333],
    [-1.3333, -0.7500, 4.1667, -0.7500, -1.3333],
    [-0.6667, 0, 2.0833, -0.7500, -0.6667],
    [-0.6667, -0.7500, 2.0833, 0, -0.6667],
    [-1.3333, -0.7500, 4.1667, -0.7500, -1.3333],
    [-1.3333, -0.7500, 4.1667, -0.7500, -1.3333],
    [-0.6667, 0, 2.0833, -0.7500, -0.6667],
    [-0.6667, -0.7500, 2.0833, 0, -0.6667],
    [-1.3333, -0.7500, 4.1667, -0.7500, -1.3333],
    [-1.3333, -0.7500, 4.1667, -0.7500, -1.3333],
    [-0.6667, 0, 2.0833, -0.7500, -0.6667],
    [0, -0.3750, 1.0417, 0, -0.6667],
    [0, -0.3750, 2.0833, -0.3750, -1.3333],
    [0, -0.3750, 2.0833, -0.3750, -1.3333],
    [0, 0, 1.0417, -0.3750, -0.6667]
])

ex23_case1_d = np.array([-4, -1, 0, 1, 4])

# Case 2: Scaled domain
ex23_case2_B = np.array([
    [-0.5175, -0.4831, 1.0006, 0, 0],
    [-1.0351, -0.4831, 2.0012, -0.4831, 0],
    [-1.0351, -0.4831, 2.0012, -0.4831, 0],
    [-0.5175, 0, 1.0006, -0.4831, 0],
    [-0.5175, -0.9661, 2.0012, 0, -0.5175],
    [-1.0351, -0.9661, 4.0024, -0.9661, -1.0351],
    [-1.0351, -0.9661, 4.0024, -0.9661, -1.0351],
    [-0.5175, 0, 2.0012, -0.9661, -0.5175],
    [-0.5175, -0.9661, 2.0012, 0, -0.5175],
    [-1.0351, -0.9661, 4.0024, -0.9661, -1.0351],
    [-1.0351, -0.9661, 4.0024, -0.9661, -1.0351],
    [-0.5175, 0, 2.0012, -0.9661, -0.5175],
    [-0.5175, -0.9661, 2.0012, 0, -0.5175],
    [-1.0351, -0.9661, 4.0024, -0.9661, -1.0351],
    [-1.0351, -0.9661, 4.0024, -0.9661, -1.0351],
    [-0.5175, 0, 2.0012, -0.9661, -0.5175],
    [0, -0.4831, 1.0006, 0, -0.5175],
    [0, -0.4831, 2.0012, -0.4831, -1.0351],
    [0, -0.4831, 2.0012, -0.4831, -1.0351],
    [0, 0, 1.0006, -0.4831, -0.5175]
])

ex23_case2_d = np.array([-4, -1, 0, 1, 4])

ex23_case2_b = np.array([
    9.3832, 9.9506, 2.6018, 0.5674,
    -0.8996, -0.4982, -15.1958, -6.9474,
    -22.1986, -43.0962, -57.7938, -28.2464,
    -43.4976, -85.6942, -100.3918, -49.5454,
    -17.3824, -53.0468, -60.3956, -43.0132
])

# ============================================================
# EXERCISE 2.4 - After Dirichlet BC application
# ============================================================

# Case 1: Unit domain
ex24_case1_B = np.array([
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [-1.3333, -0.7500, 4.1667, 0, 0],
    [-1.3333, 0, 4.1667, -0.7500, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [-1.3333, -0.7500, 4.1667, 0, -1.3333],
    [-1.3333, 0, 4.1667, -0.7500, -1.3333],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, -0.7500, 4.1667, 0, -1.3333],
    [0, 0, 4.1667, -0.7500, -1.3333],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0]
])

ex24_case1_d = np.array([-4, -1, 0, 1, 4])

ex24_case1_b = np.array([
    1.0, 1.0, 1.0, 1.0,
    1.0, 2.0833, 2.0833, 1.0,
    1.0, 0.7500, 0.7500, 1.0,
    1.0, 2.0833, 2.0833, 1.0,
    1.0, 1.0, 1.0, 1.0
])

# Case 2: Scaled domain
ex24_case2_B = np.array([
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [-1.0351, -0.9661, 4.0024, 0, 0],
    [-1.0351, 0, 4.0024, -0.9661, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [-1.0351, -0.9661, 4.0024, 0, -1.0351],
    [-1.0351, 0, 4.0024, -0.9661, -1.0351],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, -0.9661, 4.0024, 0, -1.0351],
    [0, 0, 4.0024, -0.9661, -1.0351],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0],
    [0, 0, 1.0, 0, 0]
])

ex24_case2_d = np.array([-4, -1, 0, 1, 4])

ex24_case2_b = np.array([
    -22.2900, -10.4572, 9.1111, 36.4150,
    -0.4020, -11.7107, 16.9886, 23.5520,
    0.5480, -42.5668, -26.5414, 32.3490,
    21.7140, 95.6645, 220.9047, 103.9600,
    104.2500, 154.9441, 213.3738, 279.5390
])

# ============================================================
# Save to npz
# ============================================================

np.savez(
    output_dir / 'validation_data.npz',
    # Ex 2.1
    ex21_case1_x=ex21_case1_x,
    ex21_case1_y=ex21_case1_y,
    ex21_case1_elmtab=ex21_case1_elmtab,
    ex21_case2_x=ex21_case2_x,
    ex21_case2_y=ex21_case2_y,
    # Ex 2.2
    ex22_delta=np.array([ex22_delta]),
    ex22_abc=ex22_abc,
    ex22_face1_n=ex22_face1_n,
    ex22_face2_n=ex22_face2_n,
    ex22_face3_n=ex22_face3_n,
    # Ex 2.3
    ex23_case1_B=ex23_case1_B,
    ex23_case1_d=ex23_case1_d,
    ex23_case2_B=ex23_case2_B,
    ex23_case2_d=ex23_case2_d,
    ex23_case2_b=ex23_case2_b,
    # Ex 2.4
    ex24_case1_B=ex24_case1_B,
    ex24_case1_d=ex24_case1_d,
    ex24_case1_b=ex24_case1_b,
    ex24_case2_B=ex24_case2_B,
    ex24_case2_d=ex24_case2_d,
    ex24_case2_b=ex24_case2_b,
)

print(f"Validation data saved to {output_dir / 'validation_data.npz'}")
